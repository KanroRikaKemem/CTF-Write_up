### I. MODULAR MATH:
#### 1. Quadratic Residues:
##### a) Mô tả đề bài:
- Tìm $a$ sao cho $$a^2 \equiv x \mod p$$ Nếu tồn tại $a$ thoả mãn biểu thức thì $x$ được gọi là **quadratic residue (số dư bậc hai)** modulo $p$, nếu không là **non - quadratic residue**.
- Với mỗi số dư bậc hai $x$, luôn tồn tại hai nghiệm $a$ và $-a$ $\mod p$.
- Trong tổng cộng $p - 1$ phần tử khác $0$ trong $F_p^*$, chỉ khoảng một nửa là **quadratic residue**.
- Yêu cầu cụ thể của challenge:
    - Cho: $p = 29$, $ints = [14, 6, 11]$
    - Có hai số không phải **quadratic residue**, số còn lại là **quadratic residue**.
    - Tìm căn bậc hai của số đó modulo $29$, chọn nghiệm nhỏ hơn làm flag.

##### b) Phân tích cách làm:
- Xét $a \in p - 1$ phần tử nguyên dương khác $0$ nhỏ hơn $p = 29$, với $x \in [14, 6, 11]$, tìm $a$ sao cho $$a^2 \equiv x \mod p$$
- Source code:
```py
p = 29
ints = [14, 6, 11]

for a in range (28):
    for x in ints:
        if pow(a, 2, 29) == x:
            print(a, x)
```
- Kết quả:
```
8 6
21 6
```

##### c) Kết quả:
`8`

#### 2. Legendre Symbol:
##### a) Mô tả đề bài:
- Xét challenge $p \equiv 3 \mod 4$:
    - Có mười số nguyên và một số nguyên tố $p$ $1024$ bits. Trong mười số chỉ có một số là **quadratic residue**, tìm số đó và tính căn bậc hai modulo $p$, nghiệm lớn hơn là flag.
    - Sử dụng **Legendre Symbol** để xác định một số có phải **quadratic residue** không: $$(\frac{a}{p}) = a^{(p - 1)/2} \mod p$$ Nếu kết quả là `1`, $a$ là **quadratic residue**, ngược lại là `-1`.
    - Với $p \equiv 3 \mod 4$, căn bậc hai của $a \mod p$ (nếu tồn tại) là: $$\sqrt a \equiv \pm a^{(p + 1)/4} \mod p$$
- File được cho:
```py
p = 101524035174539890485408575671085261788758965189060164484385690801466167356667036677932998889725476582421738788500738738503134356158197247473850273565349249573867251280253564698939768700489401960767007716413932851838937641880157263936985954881657889497583485535527613578457628399173971810541670838543309159139
ints = [25081841204695904475894082974192007718642931811040324543182130088804239047149283334700530600468528298920930150221871666297194395061462592781551275161695411167049544771049769000895119729307495913024360169904315078028798025169985966732789207320203861858234048872508633514498384390497048416012928086480326832803, 45471765180330439060504647480621449634904192839383897212809808339619841633826534856109999027962620381874878086991125854247108359699799913776917227058286090426484548349388138935504299609200377899052716663351188664096302672712078508601311725863678223874157861163196340391008634419348573975841578359355931590555, 17364140182001694956465593533200623738590196990236340894554145562517924989208719245429557645254953527658049246737589538280332010533027062477684237933221198639948938784244510469138826808187365678322547992099715229218615475923754896960363138890331502811292427146595752813297603265829581292183917027983351121325, 14388109104985808487337749876058284426747816961971581447380608277949200244660381570568531129775053684256071819837294436069133592772543582735985855506250660938574234958754211349215293281645205354069970790155237033436065434572020652955666855773232074749487007626050323967496732359278657193580493324467258802863, 4379499308310772821004090447650785095356643590411706358119239166662089428685562719233435615196994728767593223519226235062647670077854687031681041462632566890129595506430188602238753450337691441293042716909901692570971955078924699306873191983953501093343423248482960643055943413031768521782634679536276233318, 85256449776780591202928235662805033201684571648990042997557084658000067050672130152734911919581661523957075992761662315262685030115255938352540032297113615687815976039390537716707854569980516690246592112936796917504034711418465442893323439490171095447109457355598873230115172636184525449905022174536414781771, 50576597458517451578431293746926099486388286246142012476814190030935689430726042810458344828563913001012415702876199708216875020997112089693759638454900092580746638631062117961876611545851157613835724635005253792316142379239047654392970415343694657580353333217547079551304961116837545648785312490665576832987, 96868738830341112368094632337476840272563704408573054404213766500407517251810212494515862176356916912627172280446141202661640191237336568731069327906100896178776245311689857997012187599140875912026589672629935267844696976980890380730867520071059572350667913710344648377601017758188404474812654737363275994871, 4881261656846638800623549662943393234361061827128610120046315649707078244180313661063004390750821317096754282796876479695558644108492317407662131441224257537276274962372021273583478509416358764706098471849536036184924640593888902859441388472856822541452041181244337124767666161645827145408781917658423571721, 18237936726367556664171427575475596460727369368246286138804284742124256700367133250078608537129877968287885457417957868580553371999414227484737603688992620953200143688061024092623556471053006464123205133894607923801371986027458274343737860395496260538663183193877539815179246700525865152165600985105257601565]
```

##### b) Phân tích cách làm:
- Kiểm tra số **quadratic residue** trong danh sách `ints[]` bằng **Legendre Symbols**, nếu đúng thì tìm căn bậc hai bằng công thức: $$\sqrt a \equiv \pm a^{(p + 1)/4} \mod p$$
- Source code:
```py
p = 101524035174539890485408575671085261788758965189060164484385690801466167356667036677932998889725476582421738788500738738503134356158197247473850273565349249573867251280253564698939768700489401960767007716413932851838937641880157263936985954881657889497583485535527613578457628399173971810541670838543309159139
ints = [25081841204695904475894082974192007718642931811040324543182130088804239047149283334700530600468528298920930150221871666297194395061462592781551275161695411167049544771049769000895119729307495913024360169904315078028798025169985966732789207320203861858234048872508633514498384390497048416012928086480326832803, 45471765180330439060504647480621449634904192839383897212809808339619841633826534856109999027962620381874878086991125854247108359699799913776917227058286090426484548349388138935504299609200377899052716663351188664096302672712078508601311725863678223874157861163196340391008634419348573975841578359355931590555, 17364140182001694956465593533200623738590196990236340894554145562517924989208719245429557645254953527658049246737589538280332010533027062477684237933221198639948938784244510469138826808187365678322547992099715229218615475923754896960363138890331502811292427146595752813297603265829581292183917027983351121325, 14388109104985808487337749876058284426747816961971581447380608277949200244660381570568531129775053684256071819837294436069133592772543582735985855506250660938574234958754211349215293281645205354069970790155237033436065434572020652955666855773232074749487007626050323967496732359278657193580493324467258802863, 4379499308310772821004090447650785095356643590411706358119239166662089428685562719233435615196994728767593223519226235062647670077854687031681041462632566890129595506430188602238753450337691441293042716909901692570971955078924699306873191983953501093343423248482960643055943413031768521782634679536276233318, 85256449776780591202928235662805033201684571648990042997557084658000067050672130152734911919581661523957075992761662315262685030115255938352540032297113615687815976039390537716707854569980516690246592112936796917504034711418465442893323439490171095447109457355598873230115172636184525449905022174536414781771, 50576597458517451578431293746926099486388286246142012476814190030935689430726042810458344828563913001012415702876199708216875020997112089693759638454900092580746638631062117961876611545851157613835724635005253792316142379239047654392970415343694657580353333217547079551304961116837545648785312490665576832987, 96868738830341112368094632337476840272563704408573054404213766500407517251810212494515862176356916912627172280446141202661640191237336568731069327906100896178776245311689857997012187599140875912026589672629935267844696976980890380730867520071059572350667913710344648377601017758188404474812654737363275994871, 4881261656846638800623549662943393234361061827128610120046315649707078244180313661063004390750821317096754282796876479695558644108492317407662131441224257537276274962372021273583478509416358764706098471849536036184924640593888902859441388472856822541452041181244337124767666161645827145408781917658423571721, 18237936726367556664171427575475596460727369368246286138804284742124256700367133250078608537129877968287885457417957868580553371999414227484737603688992620953200143688061024092623556471053006464123205133894607923801371986027458274343737860395496260538663183193877539815179246700525865152165600985105257601565]

for a in ints:
    if pow(a, (p - 1)//2, p) == 1:
        print(pow(a, (p + 1)//4, p))
```

##### c) Kết quả:
```
93291799125366706806545638475797430512104976066103610269938025709952247020061090804870186195285998727680200979853848718589126765742550855954805290253592144209552123062161458584575060939481368210688629862036958857604707468372384278049741369153506182660264876115428251983455344219194133033177700490981696141526
```

#### 3. Modular Square Root:
##### a) Mô tả đề bài:
- **Tonelli - Shanks** dùng để giải phương trình $$r^2 \equiv a \mod p$$ Với $p$ là số nguyên tố và $a$ là **quadratic residue**.
    - Điều kiện áp dụng:
        - $p \equiv 1 \mod 4$: Dùng **Tonelli - Shanks**
        - $p \equiv 3 \mod 4$: Dùng $r \equiv \pm a^{(p + 1)/4} \mod p$
    - Ứng dụng chính:
        - Tính toạ độ điểm trên đường cong elliptic.
        - Là một bước trong nhiều thuật toán mật mã.
- Yêu cầu challenge: Tìm căn bậc hai của $a \mod p$ với $p$ là một số nguyên tố $2048$ bits. Flag là kết quả nhỏ hơn.
- Thông số được cho:
```py
a = 8479994658316772151941616510097127087554541274812435112009425778595495359700244470400642403747058566807127814165396640215844192327900454116257979487432016769329970767046735091249898678088061634796559556704959846424131820416048436501387617211770124292793308079214153179977624440438616958575058361193975686620046439877308339989295604537867493683872778843921771307305602776398786978353866231661453376056771972069776398999013769588936194859344941268223184197231368887060609212875507518936172060702209557124430477137421847130682601666968691651447236917018634902407704797328509461854842432015009878011354022108661461024768
p = 30531851861994333252675935111487950694414332763909083514133769861350960895076504687261369815735742549428789138300843082086550059082835141454526618160634109969195486322015775943030060449557090064811940139431735209185996454739163555910726493597222646855506445602953689527405362207926990442391705014604777038685880527537489845359101552442292804398472642356609304810680731556542002301547846635101455995732584071355903010856718680732337369128498655255277003643669031694516851390505923416710601212618443109844041514942401969629158975457079026906304328749039997262960301209158175920051890620947063936347307238412281568760161
```

##### b) Phân tích cách làm:
- Cơ sở lý thuyết:
    - **Legendre Symbol:**

    $\frac{a}{p} =$
    <table>
    <tr><td>0</td><td>nếu a ≡ 0 (mod p)</td></tr>
    <tr><td>1</td><td>nếu a là bình phương modulo p</td></tr>
    <tr><td>-1</td><td>nếu a không là bình phương modulo p</td></tr>
    </table>

    Với $\frac{a}{p} \equiv a^{(p - 1)/2} \mod p$
    - **Tonelli - Shanks:** Áp dụng khi $p \equiv 1 \mod 4$ vì nếu $p \equiv 3 \mod 4$ thì ta sử dụng $x \equiv a^{(p + 1)/4} \mod p$
- Xét $p \equiv 1 \mod 4$ hay $p - 1 = k.2^n$ (với $k$ lẻ), tìm $k$ và $n$ tương ứng.
- Tìm số nguyên $i$ sao cho $(\frac{i}{p}) \neq -1$ ($n$ không phải bình phương chính phương modulo $p$, dùng để tạo căn ảo).
- Khởi tạo:
    - Ứng viên tạm thời: $$x = a^{(k + 1)/2} \mod p$$
    - Phần kiểm tra lặp, tiến dần về $1$ nếu $x$ đúng: $$b = a^k \mod p$$
    - Giá trị điều chỉnh bằng căn không chính phương: $$g = i^k \mod p$$
    - Số mũ của $2$ trong $p - 1$: $$r = n$$
- Lặp cho đến khi tìm được $x$ thoả mãn $x^2 \equiv a \mod p$ (với ý tưởng giảm $r$, đưa $b$ về $1$ để kết thúc vòng lặp):
    - Tìm $m$ nhỏ nhất sao cho $b^{2^m} \equiv 1 \mod p$.
    - Nếu $m = 0$ thì đã tìm được $x$.
    - Cập nhật các giá trị $x$, $b$, $g$, $r$ để xấp xỉ nghiệm hơn: $$gs = g^{2^{r - m - 1}} \mod p$$ $$g = gs^2 \mod p$$ $$x = x.gs \mod p$$ $$b = b.gs \mod p$$ $$r = m$$
- Source code:
```py
a = 8479994658316772151941616510097127087554541274812435112009425778595495359700244470400642403747058566807127814165396640215844192327900454116257979487432016769329970767046735091249898678088061634796559556704959846424131820416048436501387617211770124292793308079214153179977624440438616958575058361193975686620046439877308339989295604537867493683872778843921771307305602776398786978353866231661453376056771972069776398999013769588936194859344941268223184197231368887060609212875507518936172060702209557124430477137421847130682601666968691651447236917018634902407704797328509461854842432015009878011354022108661461024768
p = 30531851861994333252675935111487950694414332763909083514133769861350960895076504687261369815735742549428789138300843082086550059082835141454526618160634109969195486322015775943030060449557090064811940139431735209185996454739163555910726493597222646855506445602953689527405362207926990442391705014604777038685880527537489845359101552442292804398472642356609304810680731556542002301547846635101455995732584071355903010856718680732337369128498655255277003643669031694516851390505923416710601212618443109844041514942401969629158975457079026906304328749039997262960301209158175920051890620947063936347307238412281568760161

def legendre_symbol(a, p):
    res = pow(a, (p - 1) // 2, p)
    if res == p - 1:
        return -1
    return res

def square_root(a, p):
    if (legendre_symbol(a, p) != 1) or (a == 0) or (p == 2):
        return 0
    elif p%4 == 3:
        return pow(a, (p + 1)//4, p)
    
    k = p - 1
    n = 0
    while k%2 == 0:
        k //= 2
        n += 1

    i = 2
    while legendre_symbol(i, p) != -1:
        i += 1

    x = pow(a, (k + 1)//2, p)
    b = pow(a, k, p)
    g = pow(i, k, p)
    r = n

    while True:
        t = b
        for m in range (r):
            if t == 1:
                break
            t = pow(t, 2, p)

        if m == 0:
            return x
        
        gs = pow(g, 2**(r - m - 1), p)
        g = pow(gs, 2, p)
        x = (x*gs)%p
        b = (b*gs)%p
        r = m

print(square_root(a, p))
```

##### c) Kết quả:
```
2362339307683048638327773298580489298932137505520500388338271052053734747862351779647314176817953359071871560041125289919247146074907151612762640868199621186559522068338032600991311882224016021222672243139362180461232646732465848840425458257930887856583379600967761738596782877851318489355679822813155123045705285112099448146426755110160002515592418850432103641815811071548456284263507805589445073657565381850521367969675699760755310784623577076440037747681760302434924932113640061738777601194622244192758024180853916244427254065441962557282572849162772740798989647948645207349737457445440405057156897508368531939120
```

#### 4. Chinese Remainder Theorem:
##### a) Mô tả đề bài:
- **Định lý phần dư Trung Hoa (Chinese Remainder Theorem):** Đảm bảo rằng một hệ phương trình đồng dư tuyến tính có nghiệm duy nhất modulo **tích các modulo**, nếu **các modulo** là **nguyên tố cùng nhau từng đôi một**.

<img width="731" height="507" alt="image" src="https://github.com/user-attachments/assets/4f82da11-601e-4b2c-a94b-8c70e49bab3b" />

- Challange:
<img width="833" height="202" alt="image" src="https://github.com/user-attachments/assets/2242d73d-df93-48af-bfac-d12dacf4a588" />

##### b) Phân tích cách làm:
<img width="842" height="760" alt="image" src="https://github.com/user-attachments/assets/dd995f0b-7b89-44ad-b238-5b9fb3c285b6" />

- Thế số vào, ta có source code:
```py
N = 935
list_n = [5, 11, 17]
list_a = [2, 3, 5]

N0 = N//list_n[0]
N1 = N//list_n[1]
N2 = N//list_n[2]

u0 = pow(N0, -1, list_n[0])
u1 = pow(N1, -1, list_n[1])
u2 = pow(N2, -1, list_n[2])

x = (list_a[0]*u0*N0 + list_a[1]*u1*N1 + list_a[2]*u2*N2) % N
print(x)
```

##### c) Kết quả:
`872`

### II. BRAINTEASERS PART 1:
#### 1. Successive Powers:
##### a) Mô tả đề bài:
- Dãy {$588$, $665$, $216$, $113$, $642$, $4$, $836$, $114$, $851$, $492$, $819$, $237$} là các luỹ thừa liên tiếp của một số $x$, tính modulo một số nguyên tố $p$ có ba chữ số.
- Yêu cầu: Tìm $x$ và $p$.

##### b) Phân tích cách làm:
- Với dãy số $x$, $x^2$, $x^3$,..., $x^n$, modulo lần lượt với $p$ sẽ ra dãy số {$588$, $665$, $216$, $113$, $642$, $4$, $836$, $114$, $851$, $492$, $819$, $237$}.
- Ta có: $$a_{n + 1} \equiv a_n.x \mod p$$ Tương đương: $$a_{n + 1}.a^{-1}_n \equiv x \mod p$$
- Hướng khai thác:
    - Xét danh sách số nguyên tố $p$ có ba chữ số và duyệt từng phần tử.
    - Với mỗi $p$, thử từng $x \in [1, p - 1]$, nếu thoả mãn biểu thức $a_{n + 1}.a^{-1}_n \equiv x \mod p$ thì in ra flag theo định dạng `crypto{p,x}`.
- Source code:
```py
from sympy import isprime

a = [588, 665, 216, 113, 642, 4, 836, 114, 851, 492, 819, 237]

for p in range (100, 1000):
    if not isprime(p):
        continue

    for x in range (1, p):
        check = True
        for i in range (len(a) - 1):
            if ((a[i]*x)%p != a[i + 1]):
                check = False
                break

        if check:
            print(f"crypto{{{p},{x}}}")
```

##### c) Kết quả:
`crypto{919,209}`

#### 2. Adrien's Signs:
##### a) Mô tả đề bài:
- *"Adrien đã xem xét các cách để mã hóa các thông điệp của anh ấy với sự giúp đỡ của các biểu tượng và dấu hiệu trừ. Bạn có thể tìm cách phục hồi flag không?"*
- Source code:
```py
from random import randint

a = 288260533169915
p = 1007621497415251

FLAG = b'crypto{????????????????????}'


def encrypt_flag(flag):
    ciphertext = []
    plaintext = ''.join([bin(i)[2:].zfill(8) for i in flag])
    for b in plaintext:
        e = randint(1, p)
        n = pow(a, e, p)
        if b == '1':
            ciphertext.append(n)
        else:
            n = -n % p
            ciphertext.append(n)
    return ciphertext


print(encrypt_flag(FLAG))
```
- File `output.txt`:
```
[67594220461269, 501237540280788, 718316769824518, 296304224247167, 48290626940198, 30829701196032, 521453693392074, 840985324383794, 770420008897119, 745131486581197, 729163531979577, 334563813238599, 289746215495432, 538664937794468, 894085795317163, 983410189487558, 863330928724430, 996272871140947, 352175210511707, 306237700811584, 631393408838583, 589243747914057, 538776819034934, 365364592128161, 454970171810424, 986711310037393, 657756453404881, 388329936724352, 90991447679370, 714742162831112, 62293519842555, 653941126489711, 448552658212336, 970169071154259, 339472870407614, 406225588145372, 205721593331090, 926225022409823, 904451547059845, 789074084078342, 886420071481685, 796827329208633, 433047156347276, 21271315846750, 719248860593631, 534059295222748, 879864647580512, 918055794962142, 635545050939893, 319549343320339, 93008646178282, 926080110625306, 385476640825005, 483740420173050, 866208659796189, 883359067574584, 913405110264883, 898864873510337, 208598541987988, 23412800024088, 911541450703474, 57446699305445, 513296484586451, 180356843554043, 756391301483653, 823695939808936, 452898981558365, 383286682802447, 381394258915860, 385482809649632, 357950424436020, 212891024562585, 906036654538589, 706766032862393, 500658491083279, 134746243085697, 240386541491998, 850341345692155, 826490944132718, 329513332018620, 41046816597282, 396581286424992, 488863267297267, 92023040998362, 529684488438507, 925328511390026, 524897846090435, 413156582909097, 840524616502482, 325719016994120, 402494835113608, 145033960690364, 43932113323388, 683561775499473, 434510534220939, 92584300328516, 763767269974656, 289837041593468, 11468527450938, 628247946152943, 8844724571683, 813851806959975, 72001988637120, 875394575395153, 70667866716476, 75304931994100, 226809172374264, 767059176444181, 45462007920789, 472607315695803, 325973946551448, 64200767729194, 534886246409921, 950408390792175, 492288777130394, 226746605380806, 944479111810431, 776057001143579, 658971626589122, 231918349590349, 699710172246548, 122457405264610, 643115611310737, 999072890586878, 203230862786955, 348112034218733, 240143417330886, 927148962961842, 661569511006072, 190334725550806, 763365444730995, 516228913786395, 846501182194443, 741210200995504, 511935604454925, 687689993302203, 631038090127480, 961606522916414, 138550017953034, 932105540686829, 215285284639233, 772628158955819, 496858298527292, 730971468815108, 896733219370353, 967083685727881, 607660822695530, 650953466617730, 133773994258132, 623283311953090, 436380836970128, 237114930094468, 115451711811481, 674593269112948, 140400921371770, 659335660634071, 536749311958781, 854645598266824, 303305169095255, 91430489108219, 573739385205188, 400604977158702, 728593782212529, 807432219147040, 893541884126828, 183964371201281, 422680633277230, 218817645778789, 313025293025224, 657253930848472, 747562211812373, 83456701182914, 470417289614736, 641146659305859, 468130225316006, 46960547227850, 875638267674897, 662661765336441, 186533085001285, 743250648436106, 451414956181714, 527954145201673, 922589993405001, 242119479617901, 865476357142231, 988987578447349, 430198555146088, 477890180119931, 844464003254807, 503374203275928, 775374254241792, 346653210679737, 789242808338116, 48503976498612, 604300186163323, 475930096252359, 860836853339514, 994513691290102, 591343659366796, 944852018048514, 82396968629164, 152776642436549, 916070996204621, 305574094667054, 981194179562189, 126174175810273, 55636640522694, 44670495393401, 74724541586529, 988608465654705, 870533906709633, 374564052429787, 486493568142979, 469485372072295, 221153171135022, 289713227465073, 952450431038075, 107298466441025, 938262809228861, 253919870663003, 835790485199226, 655456538877798, 595464842927075, 191621819564547]
```
##### b) Phân tích cách làm:
- Đề cho một list các giá trị `ciphertext` và một số nguyên tố lớn $p$. Mỗi `ciphetext[i]` tượng trưng cho một bit $0$ hoặc $1$ trong flag.
- Ta thấy $p \equiv 3 \mod 4$ nên dùng **Legendre Symbol**: $$(\frac{c}{p}) = c^{(p - 1)/2} \mod p$$ Với $c$ là từng số trong `ciphertext`.
    - Nếu $(\frac{c}{p}) = 1$, bit bằng $1$.
    - Nếu $(\frac{c}{p}) = -1$, bit bằng $0$.
- Sau khi ghép tất cả các bit thành một chuỗi nhị phân lớn, chuyển nó về số nguyên và chuyển về dạng byte.
- Source code:
```py
from Crypto.Util.number import long_to_bytes

a = 288260533169915
p = 1007621497415251
ciphertext = [67594220461269, 501237540280788, 718316769824518, 296304224247167, 48290626940198, 30829701196032, 521453693392074, 840985324383794, 770420008897119, 745131486581197, 729163531979577, 334563813238599, 289746215495432, 538664937794468, 894085795317163, 983410189487558, 863330928724430, 996272871140947, 352175210511707, 306237700811584, 631393408838583, 589243747914057, 538776819034934, 365364592128161, 454970171810424, 986711310037393, 657756453404881, 388329936724352, 90991447679370, 714742162831112, 62293519842555, 653941126489711, 448552658212336, 970169071154259, 339472870407614, 406225588145372, 205721593331090, 926225022409823, 904451547059845, 789074084078342, 886420071481685, 796827329208633, 433047156347276, 21271315846750, 719248860593631, 534059295222748, 879864647580512, 918055794962142, 635545050939893, 319549343320339, 93008646178282, 926080110625306, 385476640825005, 483740420173050, 866208659796189, 883359067574584, 913405110264883, 898864873510337, 208598541987988, 23412800024088, 911541450703474, 57446699305445, 513296484586451, 180356843554043, 756391301483653, 823695939808936, 452898981558365, 383286682802447, 381394258915860, 385482809649632, 357950424436020, 212891024562585, 906036654538589, 706766032862393, 500658491083279, 134746243085697, 240386541491998, 850341345692155, 826490944132718, 329513332018620, 41046816597282, 396581286424992, 488863267297267, 92023040998362, 529684488438507, 925328511390026, 524897846090435, 413156582909097, 840524616502482, 325719016994120, 402494835113608, 145033960690364, 43932113323388, 683561775499473, 434510534220939, 92584300328516, 763767269974656, 289837041593468, 11468527450938, 628247946152943, 8844724571683, 813851806959975, 72001988637120, 875394575395153, 70667866716476, 75304931994100, 226809172374264, 767059176444181, 45462007920789, 472607315695803, 325973946551448, 64200767729194, 534886246409921, 950408390792175, 492288777130394, 226746605380806, 944479111810431, 776057001143579, 658971626589122, 231918349590349, 699710172246548, 122457405264610, 643115611310737, 999072890586878, 203230862786955, 348112034218733, 240143417330886, 927148962961842, 661569511006072, 190334725550806, 763365444730995, 516228913786395, 846501182194443, 741210200995504, 511935604454925, 687689993302203, 631038090127480, 961606522916414, 138550017953034, 932105540686829, 215285284639233, 772628158955819, 496858298527292, 730971468815108, 896733219370353, 967083685727881, 607660822695530, 650953466617730, 133773994258132, 623283311953090, 436380836970128, 237114930094468, 115451711811481, 674593269112948, 140400921371770, 659335660634071, 536749311958781, 854645598266824, 303305169095255, 91430489108219, 573739385205188, 400604977158702, 728593782212529, 807432219147040, 893541884126828, 183964371201281, 422680633277230, 218817645778789, 313025293025224, 657253930848472, 747562211812373, 83456701182914, 470417289614736, 641146659305859, 468130225316006, 46960547227850, 875638267674897, 662661765336441, 186533085001285, 743250648436106, 451414956181714, 527954145201673, 922589993405001, 242119479617901, 865476357142231, 988987578447349, 430198555146088, 477890180119931, 844464003254807, 503374203275928, 775374254241792, 346653210679737, 789242808338116, 48503976498612, 604300186163323, 475930096252359, 860836853339514, 994513691290102, 591343659366796, 944852018048514, 82396968629164, 152776642436549, 916070996204621, 305574094667054, 981194179562189, 126174175810273, 55636640522694, 44670495393401, 74724541586529, 988608465654705, 870533906709633, 374564052429787, 486493568142979, 469485372072295, 221153171135022, 289713227465073, 952450431038075, 107298466441025, 938262809228861, 253919870663003, 835790485199226, 655456538877798, 595464842927075, 191621819564547]

def legendre_symbol(c, p):
    if pow(c, (p - 1)//2, p) == 1:
        return 1
    elif pow(c, (p - 1)//2, p) == p - 1:
        return -1

flag = ''
for c in ciphertext:
    if legendre_symbol(c, p) == 1:
        flag += '1'
    else:
        flag += '0'

print(long_to_bytes(int(flag, 2)))
```

##### c) Kết quả:
`crypto{p4tterns_1n_re5idu3s}`

#### 3. Modular Binomials:
##### a) Mô tả đề bài:
- Sắp xếp lại các phương trình sau để có được số nguyên tố $p$, $q$: $$N = p.q$$ $$c_1 = (2p + 3q)^{e_1} \mod N$$ $$c_2 = (5p + 7q)^{e_2} \mod N$$
- File `data.txt`:
```py
N = 14905562257842714057932724129575002825405393502650869767115942606408600343380327866258982402447992564988466588305174271674657844352454543958847568190372446723549627752274442789184236490768272313187410077124234699854724907039770193680822495470532218905083459730998003622926152590597710213127952141056029516116785229504645179830037937222022291571738973603920664929150436463632305664687903244972880062028301085749434688159905768052041207513149370212313943117665914802379158613359049957688563885391972151218676545972118494969247440489763431359679770422939441710783575668679693678435669541781490217731619224470152467768073
e1 = 12886657667389660800780796462970504910193928992888518978200029826975978624718627799215564700096007849924866627154987365059524315097631111242449314835868137
e2 = 12110586673991788415780355139635579057920926864887110308343229256046868242179445444897790171351302575188607117081580121488253540215781625598048021161675697
c1 = 14010729418703228234352465883041270611113735889838753433295478495763409056136734155612156934673988344882629541204985909650433819205298939877837314145082403528055884752079219150739849992921393509593620449489882380176216648401057401569934043087087362272303101549800941212057354903559653373299153430753882035233354304783275982332995766778499425529570008008029401325668301144188970480975565215953953985078281395545902102245755862663621187438677596628109967066418993851632543137353041712721919291521767262678140115188735994447949166616101182806820741928292882642234238450207472914232596747755261325098225968268926580993051
c2 = 14386997138637978860748278986945098648507142864584111124202580365103793165811666987664851210230009375267398957979494066880296418013345006977654742303441030008490816239306394492168516278328851513359596253775965916326353050138738183351643338294802012193721879700283088378587949921991198231956871429805847767716137817313612304833733918657887480468724409753522369325138502059408241232155633806496752350562284794715321835226991147547651155287812485862794935695241612676255374480132722940682140395725089329445356434489384831036205387293760789976615210310436732813848937666608611803196199865435145094486231635966885932646519
```
##### b) Phân tích cách làm:
Dùng factordb.com, được:
```py
p = 112274000169258486390262064441991200608556376127408952701514962644340921899196091557519382763356534106376906489445103255177593594898966250176773605432765983897105047795619470659157057093771407309168345670541418772427807148039207489900810013783673957984006269120652134007689272484517805398390277308001719431273
q = 132760587806365301971479157072031448380135765794466787456948786731168095877956875295282661565488242190731593282663694728914945967253173047324353981530949360031535707374701705328450856944598803228299967009004598984671293494375599408764139743217465012770376728876547958852025425539298410751132782632817947101601
```
##### c) Kết quả:
```
crypto{112274000169258486390262064441991200608556376127408952701514962644340921899196091557519382763356534106376906489445103255177593594898966250176773605432765983897105047795619470659157057093771407309168345670541418772427807148039207489900810013783673957984006269120652134007689272484517805398390277308001719431273,132760587806365301971479157072031448380135765794466787456948786731168095877956875295282661565488242190731593282663694728914945967253173047324353981530949360031535707374701705328450856944598803228299967009004598984671293494375599408764139743217465012770376728876547958852025425539298410751132782632817947101601}
```

#### 4. Broken RSA:
##### a) Mô tả đề bài:
- *"Tôi đã cố gắng gửi cho bạn một tin nhắn quan trọng với RSA, tuy nhiên tôi đã làm hỏng việc triển khai RSA của mình rất tệ. Bạn vẫn có thể phục hồi flag?"*
> *"Nếu bạn nghĩ rằng bạn đang làm đúng nhưng nhận được rác, hãy chắc chắn kiểm tra tất cả các giải pháp có thể."*
- File `broken_rsa.txt`:
```py
n = 27772857409875257529415990911214211975844307184430241451899407838750503024323367895540981606586709985980003435082116995888017731426634845808624796292507989171497629109450825818587383112280639037484593490692935998202437639626747133650990603333094513531505209954273004473567193235535061942991750932725808679249964667090723480397916715320876867803719301313440005075056481203859010490836599717523664197112053206745235908610484907715210436413015546671034478367679465233737115549451849810421017181842615880836253875862101545582922437858358265964489786463923280312860843031914516061327752183283528015684588796400861331354873
e = 16
ct = 11303174761894431146735697569489134747234975144162172162401674567273034831391936916397234068346115459134602443963604063679379285919302225719050193590179240191429612072131629779948379821039610415099784351073443218911356328815458050694493726951231241096695626477586428880220528001269746547018741237131741255022371957489462380305100634600499204435763201371188769446054925748151987175656677342779043435047048130599123081581036362712208692748034620245590448762406543804069935873123161582756799517226666835316588896306926659321054276507714414876684738121421124177324568084533020088172040422767194971217814466953837590498718
```

##### b) Phân tích cách làm:
<img width="784" height="318" alt="image" src="https://github.com/user-attachments/assets/9b5796ac-0230-4b3b-bc13-24b706d8fc89" />

- Osint code mạng:

<img width="1199" height="725" alt="image" src="https://github.com/user-attachments/assets/83a54ce8-8275-4ab7-8ed9-815496507d11" />

```py
from number import *
from Crypto.Util.number import long_to_bytes

n = 27772857409875257529415990911214211975844307184430241451899407838750503024323367895540981606586709985980003435082116995888017731426634845808624796292507989171497629109450825818587383112280639037484593490692935998202437639626747133650990603333094513531505209954273004473567193235535061942991750932725808679249964667090723480397916715320876867803719301313440005075056481203859010490836599717523664197112053206745235908610484907715210436413015546671034478367679465233737115549451849810421017181842615880836253875862101545582922437858358265964489786463923280312860843031914516061327752183283528015684588796400861331354873
e = 16
ct = 11303174761894431146735697569489134747234975144162172162401674567273034831391936916397234068346115459134602443963604063679379285919302225719050193590179240191429612072131629779948379821039610415099784351073443218911356328815458050694493726951231241096695626477586428880220528001269746547018741237131741255022371957489462380305100634600499204435763201371188769446054925748151987175656677342779043435047048130599123081581036362712208692748034620245590448762406543804069935873123161582756799517226666835316588896306926659321054276507714414876684738121421124177324568084533020088172040422767194971217814466953837590498718

R.<x> = Zmod(n)[]
f = x^2 - c
r8 = [i[0] for i in f.roots()]
r4, r2, r = [], [], []

for rr8 in r8:
    f = x^2 - rr8
    r4 += [i[0] for i in f.roots()]

for rr4 in r4:
    f = x^2 - rr4
    r2 += [i[0] for i in f.roots()]

for rr2 in r2:
    f = x^2 - rr2
    r += [i[0] for i in f.roots()]

for m in r:
    print(long_to_bytes(m))
```
Tuy nhiên code trên không chạy được vì sai.
- Kết quả:

<img width="805" height="84" alt="image" src="https://github.com/user-attachments/assets/97bb83b9-6e2c-4099-9de1-54a50c4e185d" />

##### c) Kết quả:
`crypto{m0dul4r_squ4r3_r00t}`
### III. BRAINTEASERS PART 2:
### IV. PRIMES:
